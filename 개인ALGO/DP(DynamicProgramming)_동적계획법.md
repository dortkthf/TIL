# 다이나믹 프로그래밍(Dynamic Programming) or 동적 계획법

한 번 계산한 문제는 다시 계산하지 않도록 한다! 는 다이나믹 프로그래밍에 대해서 구현해보자

다이나믹 프로그래밍은 **메모리 공간을 약간 더 사용** 해서 연산 속도를 비약적으로 증가시키는 방법이다. 다음과 같은 2가지 조건을 만족할 때 다이나믹 프로그래밍을 사용할 수 있다.

- 큰 문제를 작은 문제로 나눌 수 있다.
- 작은 문제에서 구한 정답은 그것을 포함하는 큰 문제에서도 동일하다.

위 조건을 만족하는 대표적인 문제가 피보나치 수열 문제이다. 피보나치 수열은 다음과 같은 점화식을 만족하는 수열이다.

![image-20220824015533426](DP(DynamicProgramming)_동적계획법.assets/image-20220824015533426.png)

피보나치 수열을 Python의 재귀 함수로 구현한다면 다음과 같이 구현할 수 있다.

```python
import time
# 피보나치 수열 재귀함수 구현
def fibo(x):
    if x == 1 or x == 2:
        return 1
    else:
        return fibo(x-1) + fibo(x-2)
    
# 반복문을 통한 피보나치 재귀함수의 러닝타임 측정
for i in range(5,40,10):
    start = time.time() # 1970년 1월 1일 0시 0분 0초 이후 경과한 시간을 초단위로 반환 2021년 기준 대략 16억의 값을 가진다.
    res = fibo(num)
    print(res,'-> 러닝타임', round(time.time()-start,2),'초')
```

![image-20220824020330432](DP(DynamicProgramming)_동적계획법.assets/image-20220824020330432.png)

위와 같이 단순 재귀함수로 구현했을 때 x 값이 커짐에 따라 연산 수행시간이 기하 급수적으로 늘어남을 관찰할수 있다.

따라서 이러한 문제를 해결하기 위해 다이나믹 프로그래밍을 사용해야 한다.

 다이나믹 프로그래밍의 포인트는 한 번 결과를 수행한 것을 메모리에 저장해 놓고 다음에 똑같은 결과가 필요하면 그 때 다시 연산하지 않고 메모리에 저장된 그 값을 가져와 쓰는 것이다.

이러한 것을 메모제이션(캐싱) 기법 이라고도 한다. 다음은 재귀함수를 사용한 다이나믹 프로그래밍으로 피보나치 수열을 구현한 코드이다.

```python
# 메모제이션(캐싱) 기법을 활용한 Top-Down 방식의 다이나믹 프로그래밍방식
# 큰 문제를 해결하기 위해 작은 문제를 호출하는 것이다.

import time

d = [0]*50

def fibo(x):
    if x == 1 or x == 2:
        return 1
   	if d[x] != 0:
        return d[x]
   	d[x] = fibo(x-1) + fibo(x-2)
    return d[x]

for num in range(5,40,10):
    start = time.time()
    res = fibo(num)
    print(res,'->러닝타임:',round(time.time()-start,2),'초')
```

![image-20220824022234751](DP(DynamicProgramming)_동적계획법.assets/image-20220824022234751.png)

단순 재귀함수로 구현한 것과는 다르게 x 값이 증가해도 함수 러닝타임이 기하급수적으로 증가하지 않는다.

반면에 재귀함수를 사용하지 않고 단순 반복문을 사용해 다이나믹 프로그래밍을 구현할 수 있다.

```python
# Bottom-up 방식을 이용한 DP테이블

d = [0]*100

d[1] = 1 # 첫 번째 항
d[2] = 1 # 두 번째 항
N = 99   # 피보나치 수열의 99번째 숫자는?

for i in range(3,N+1):
    d[i] = d[i-1] + d[i-2]
print(d[N])
```

위와 같은 방식은 작은 문제부터 차근차근 답을 도출해서 큰 문제를 해결한다고 하여 Bottom-Up 방식이라고 한다. 

**Top-Down 방식에서는 이미 수행한 결과를 저장하는 것을 메모제이션**,

**Bottom-Up 방식에서는 DP 테이블 이라고 한다.**



책의 저자 나동빈은 단순 반복문을 활용하는 Bottom-Up 방식으로 다이나믹 프로그래밍을 해결하라고 권장한다. 만약 재귀함수를 사용하는 Top-Down 방식을 사용하다 보면 재귀 횟수 제한 오류가 걸릴 수도 있기 때문이다. 물론 이러한 오류가 났을 때 sys 라이브러리의 setrecursionlimit() 메서드를 호출해서 재귀 제한 횟수를 늘려주는 방법도 있다고 한다.